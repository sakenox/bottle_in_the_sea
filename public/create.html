<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create a Bottle</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Create a Note</h1>
        <form id="create-note-form" class="mt-3">
            <div class="form-group">
                <textarea id="content" class="form-control" placeholder="Write your message here..." maxlength="512"></textarea>
            </div>
            <input type="hidden" id="ip_created" value="your_ip_address"> <!-- Replace with actual IP logic if needed -->
            <button type="submit" class="btn btn-primary">Create Note</button>
        </form>
        <div id="message" class="alert mt-3" style="display: none;"></div>
        <a href="/" class="btn btn-primary">Home</a>
        <script>
            document.getElementById('create-note-form').addEventListener('submit', async function (e) {
                e.preventDefault();
                const content = document.getElementById('content').value;
                const responseMessage = document.getElementById('message');
                responseMessage.style.display = 'block';

                // Check the length of the content
                if (content.length > 512) {
                    responseMessage.className = 'message error';
                    responseMessage.innerText = 'The message exceeds the maximum length of 512 characters.';
                    return;
                }

                try {
                    const response = await fetch('/create-note', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ content })
                    });
                    const result = await response.text();
                    responseMessage.className = 'message success';
                    responseMessage.innerText = result;
                } catch (error) {
                    responseMessage.className = 'message error';
                    responseMessage.innerText = 'An error occurred while creating the note.';
                }
            });
        </script>
    </div>
</body>
</html>
